<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Video</title>
    <meta name="description" content="Video - A-Frame">
    <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
    <script>
        AFRAME.registerComponent('play-on-click', {
            init: function () {
                this.onClick = this.onClick.bind(this);
            },
            play: function () {
                window.addEventListener('click', this.onClick);
            },
            pause: function () {
                window.removeEventListener('click', this.onClick);
            },
            onClick: function (evt) {
                var videoEl = this.el.getAttribute('material').src;
                if (!videoEl) { return; }
                this.el.object3D.visible = true;
                document.querySelector('#cursor').setAttribute('visible', true);
                document.querySelector('#message').setAttribute('visible', false);
                
                videoEl.play();
            }
        });
        AFRAME.registerComponent('event-interact', {
            init: function () {
            this.el.addEventListener( 'mousemove', () => {
                console.log('move');
                var videoEl = document.querySelector('#videosphere').getAttribute('material').src;
                if (!videoEl) { return; }
                videoEl.play();
                console.log('start');
            });
            }
        });
    </script>

  </head>
  <body>
    <a-scene>
      <a-assets>
        <video id="video-360" preload="auto"
               src="../videos/london-bridge-360.mp4"
               autoplay loop="true"
               crossOrigin="anonymous"></video>
      </a-assets>

      <a-videosphere 
        id="videosphere"
        src="#video-360" 
        play-on-click 
        event-interact
        class="collidable"
        visible="false">
      </a-videosphere>

      <a-camera>
        <!-- message asking to click for video to play -->
        <a-entity
          id="message"
          position="0 0 -1.5"
          text="align: center;
                width: 6;
                wrapCount: 100;
                color: black;
                value: Click or tap to start video">
        </a-entity>
        <!-- cursor showing view focus -->
        <a-cursor 
          id="cursor" 
          geometry="primitive: ring; radiusInner: 0.005; radiusOuter: 0.02" 
          color="#FFF"
          raycaster="objects:.collidable"
          visible="false">
        </a-cursor>
      </a-camera>
    </a-scene>
  </body>
</html>